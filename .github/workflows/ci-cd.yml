name: CI/CD Pipeline

on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Setup .NET
      uses: actions/setup-dotnet@v4
      with:
        dotnet-version: '7.0.x'
        
    - name: Restore dependencies
      run: dotnet restore
      
    - name: Build
      run: dotnet build --no-restore -c Release
      
    - name: Publish
      run: dotnet publish --no-build -c Release -o ./publish
      
    - name: Upload build artifacts
      uses: actions/upload-artifact@v4
      with:
        name: blazor-wasm-app
        path: ./publish/wwwroot
        retention-days: 7

  # Optional: Deploy to GitHub Pages
  # Uncomment and configure when ready to deploy
  # deploy:
  #   needs: build
  #   runs-on: ubuntu-latest
  #   if: github.ref == 'refs/heads/main' || github.ref == 'refs/heads/master'
  #   permissions:
  #     contents: read
  #     pages: write
  #     id-token: write
  #   
  #   steps:
  #   - name: Checkout
  #     uses: actions/checkout@v4
  #     
  #   - name: Download artifacts
  #     uses: actions/download-artifact@v4
  #     with:
  #       name: blazor-wasm-app
  #       path: ./deploy
  #       
  #   - name: Setup Pages
  #     uses: actions/configure-pages@v4
  #     
  #   - name: Upload artifact
  #     uses: actions/upload-pages-artifact@v4
  #     with:
  #       path: './deploy'
  #       
  #   - name: Deploy to GitHub Pages
  #     id: deployment
  #     uses: actions/deploy-pages@v4

